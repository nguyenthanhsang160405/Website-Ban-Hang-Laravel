<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý sản phẩm</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex justify-center items-center">
    <div class="bg-white shadow-lg rounded-lg p-6 w-full max-w-4xl">
        <h2 class="text-2xl font-bold text-center mb-4">Quản lý Sản Phẩm</h2>

        <!-- Bảng hiển thị sản phẩm -->
        <table class="w-full border-collapse border border-gray-300">
            <thead>
                <tr class="bg-gray-200">
                    <th class="border p-2">Sản phẩm</th>
                    <th class="border p-2">Size</th>
                    <th class="border p-2">Màu</th>
                    <th class="border p-2">Tồn kho</th>
                    <th class="border p-2">Thao tác</th>
                </tr>
            </thead>
            <tbody id="product-list">
                <!-- Dữ liệu sản phẩm sẽ được thêm vào đây -->
            </tbody>
        </table>
    </div>

    <!-- Modal chỉnh sửa số lượng -->
    <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
        <div class="bg-white p-5 rounded shadow-lg w-96">
            <h2 class="text-xl font-bold mb-4">Chỉnh sửa số lượng</h2>
            <input type="number" id="editStock" class="w-full p-2 border rounded mb-3">
            <div class="flex justify-end gap-2">
                <button onclick="closeModal()" class="bg-gray-500 text-white px-4 py-2 rounded">Hủy</button>
                <button onclick="saveStock()" class="bg-blue-600 text-white px-4 py-2 rounded">Lưu</button>
            </div>
        </div>
    </div>

    <script>
        // Mảng lưu trữ danh sách sản phẩm (Giả lập dữ liệu từ backend)
        let products = [
            { id: 1, name: "Áo thun", variants: [
                { size: "S", color: "Đỏ", stock: 10 },
                { size: "M", color: "Đỏ", stock: 5 },
                { size: "L", color: "Xanh", stock: 8 }
            ]},
            { id: 2, name: "Quần jean", variants: [
                { size: "M", color: "Đen", stock: 12 },
                { size: "L", color: "Xanh", stock: 7 }
            ]}
        ];

        let currentProduct, currentVariant;

        function loadProducts() {
            const productList = document.getElementById("product-list");
            productList.innerHTML = "";

            products.forEach(product => {
                product.variants.forEach((variant, index) => {
                    let row = document.createElement("tr");
                    row.classList.add("border");

                    row.innerHTML = `
                        <td class="border p-2 ${index === 0 ? '' : 'hidden'}" rowspan="${product.variants.length}">
                            ${product.name}
                        </td>
                        <td class="border p-2">${variant.size}</td>
                        <td class="border p-2">${variant.color}</td>
                        <td class="border p-2">${variant.stock}</td>
                        <td class="border p-2">
                            <button onclick="editStock(${product.id}, '${variant.size}', '${variant.color}')" 
                                    class="bg-blue-500 text-white px-3 py-1 rounded">
                                Sửa
                            </button>
                        </td>
                    `;

                    productList.appendChild(row);
                });
            });
        }

        function editStock(productId, size, color) {
            currentProduct = products.find(p => p.id === productId);
            currentVariant = currentProduct.variants.find(v => v.size === size && v.color === color);

            document.getElementById("editStock").value = currentVariant.stock;
            document.getElementById("editModal").classList.remove("hidden");
        }

        function saveStock() {
            currentVariant.stock = parseInt(document.getElementById("editStock").value);
            closeModal();
            loadProducts();
        }

        function closeModal() {
            document.getElementById("editModal").classList.add("hidden");
        }

        loadProducts();
    </script>
</body>
</html>